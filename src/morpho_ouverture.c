/* -------------------------- */
/* --- morpho_ouverture.c --- */
/* -------------------------- */

/*
 * Copyright (c) 2020 - 2021, Lionel Lacassagne, All rights reserved
  
 
 */

#include <stdio.h>
#include <stdlib.h>
#include <stddef.h>
#include <string.h>

#include "macro.h"
#include "nrtype.h"
#include "nrdef.h"
#include "nrutil.h"
//#include "sequence.h"

#include "swp.h"
#include "morpho.h"
#include "morpho_erosion.h"
#include "morpho_dilatation.h"

// -------------------------------------------------------------------------------------
void line_ouverture3_ui8matrix_fusion_basic(uint8 **X, int i, int j0, int j1, uint8 **Y)
// -------------------------------------------------------------------------------------
{
    uint8 x[5][5];
    uint8 z[3][3];
    uint8 max;

    for(int j = j0 ; j <= j1 ; j++ ){
        x[0][0]=load2(X,i-2,j-2);
        x[1][0]=load2(X,i-1,j-2);
        x[2][0]=load2(X,i  ,j-2);
        x[3][0]=load2(X,i+1,j-2);
        x[4][0]=load2(X,i+2,j-2);

        x[0][1]=load2(X,i-2,j-1);
        x[1][1]=load2(X,i-1,j-1);
        x[2][1]=load2(X,i  ,j-1);
        x[3][1]=load2(X,i+1,j-1);
        x[4][1]=load2(X,i+2,j-1);

        x[0][2]=load2(X,i-2,j  );
        x[1][2]=load2(X,i-1,j  );
        x[2][2]=load2(X,i  ,j  );
        x[3][2]=load2(X,i+1,j  );
        x[4][2]=load2(X,i+2,j  );

        x[0][3]=load2(X,i-2,j+1);
        x[1][3]=load2(X,i-1,j+1);
        x[2][3]=load2(X,i  ,j+1);
        x[3][3]=load2(X,i+1,j+1);
        x[4][3]=load2(X,i+2,j+1);

        x[0][4]=load2(X,i-2,j+2);
        x[1][4]=load2(X,i-1,j+2);
        x[2][4]=load2(X,i  ,j+2);
        x[3][4]=load2(X,i+1,j+2);
        x[4][4]=load2(X,i+2,j+2);

        z[0][0]=and9_mat33(x,0,0);
        z[0][1]=and9_mat33(x,0,1);
        z[0][2]=and9_mat33(x,0,2);

        z[1][0]=and9_mat33(x,1,0);
        z[1][1]=and9_mat33(x,1,1);
        z[1][2]=and9_mat33(x,1,2);

        z[2][0]=and9_mat33(x,2,0);
        z[2][1]=and9_mat33(x,2,1);
        z[2][2]=and9_mat33(x,2,2);

        max=or9_mat33(z,0,0);
        store2(Y,i,j,max);
    }
}
// -----------------------------------------------------------------------------------
void line_ouverture3_ui8matrix_fusion_red_mat(uint8 **X, int i, int j0, int j1, uint8 **Y)
// -----------------------------------------------------------------------------------
{
    uint8 x[5][5];
    uint8 z[3][3];
    uint8 max;

    for(int j = j0 ; j <= j1 ; j++ ){
        x[0][0]=load2(X,i-2,j-2);
        x[1][0]=load2(X,i-1,j-2);
        x[2][0]=load2(X,i  ,j-2);
        x[3][0]=load2(X,i+1,j-2);
        x[4][0]=load2(X,i+2,j-2);

        x[0][1]=load2(X,i-2,j-1);
        x[1][1]=load2(X,i-1,j-1);
        x[2][1]=load2(X,i  ,j-1);
        x[3][1]=load2(X,i+1,j-1);
        x[4][1]=load2(X,i+2,j-1);

        x[0][2]=load2(X,i-2,j  );
        x[1][2]=load2(X,i-1,j  );
        x[2][2]=load2(X,i  ,j  );
        x[3][2]=load2(X,i+1,j  );
        x[4][2]=load2(X,i+2,j  );

        x[0][3]=load2(X,i-2,j+1);
        x[1][3]=load2(X,i-1,j+1);
        x[2][3]=load2(X,i  ,j+1);
        x[3][3]=load2(X,i+1,j+1);
        x[4][3]=load2(X,i+2,j+1);

        x[0][4]=load2(X,i-2,j+2);
        x[1][4]=load2(X,i-1,j+2);
        x[2][4]=load2(X,i  ,j+2);
        x[3][4]=load2(X,i+1,j+2);
        x[4][4]=load2(X,i+2,j+2);

        z[0][0]=and9_mat33(x,0,0);
        z[0][1]=and9_mat33(x,0,1);
        z[0][2]=and9_mat33(x,0,2);

        z[1][0]=and9_mat33(x,1,0);
        z[1][1]=and9_mat33(x,1,1);
        z[1][2]=and9_mat33(x,1,2);

        z[2][0]=and9_mat33(x,2,0);
        z[2][1]=and9_mat33(x,2,1);
        z[2][2]=and9_mat33(x,2,2);

        max=or9_mat33(z,0,0);
        store2(Y,i,j,max);
    }
}
// ----------------------------------------------------------------------------------------
void line_ouverture3_ui8matrix_fusion_red(uint8 **X, int i, int j0, int j1, uint8 **Y)
// -----------------------------------------------------------------------------------
{
    uint8   x00,x01,x02,x03,x04,
            x10,x11,x12,x13,x14,
            x20,x21,x22,x23,x24,
            x30,x31,x32,x33,x34,
            x40,x41,x42,x43,x44;
    uint8   z00,z01,z02,
            z10,z11,z12,
            z20,z21,z22;
    uint8 max;

    for(int j = j0 ; j <= j1 ; j++ ){
        x00=load2(X,i-2,j-2);
        x10=load2(X,i-1,j-2);
        x20=load2(X,i  ,j-2);
        x30=load2(X,i+1,j-2);
        x40=load2(X,i+2,j-2);

        x01=load2(X,i-2,j-1);
        x11=load2(X,i-1,j-1);
        x21=load2(X,i  ,j-1);
        x31=load2(X,i+1,j-1);
        x41=load2(X,i+2,j-1);

        x02=load2(X,i-2,j  );
        x12=load2(X,i-1,j  );
        x22=load2(X,i  ,j  );
        x32=load2(X,i+1,j  );
        x42=load2(X,i+2,j  );

        x03=load2(X,i-2,j+1);
        x13=load2(X,i-1,j+1);
        x23=load2(X,i  ,j+1);
        x33=load2(X,i+1,j+1);
        x43=load2(X,i+2,j+1);

        x04=load2(X,i-2,j+2);
        x14=load2(X,i-1,j+2);
        x24=load2(X,i  ,j+2);
        x34=load2(X,i+1,j+2);
        x44=load2(X,i+2,j+2);

        z00 = and9( x00,x01,x02,
                    x10,x11,x12,
                    x20,x21,x22);

        z10 = and9( x10,x11,x12,
                    x20,x21,x22,
                    x30,x31,x32);

        z20 = and9( x20,x21,x22,
                    x30,x31,x32,
                    x40,x41,x42);

        z01 = and9( x01,x02,x03,
                    x11,x12,x13,
                    x21,x22,x23);

        z11 = and9( x11,x12,x13,
                    x21,x22,x23,
                    x31,x32,x33);

        z21 = and9( x21,x22,x23,
                    x31,x32,x33,
                    x41,x42,x43);

        z02 = and9( x02,x03,x04,
                    x12,x13,x14,
                    x22,x23,x24);

        z12 = and9( x12,x13,x14,
                    x22,x23,x24,
                    x32,x33,x34);

        z22 = and9( x22,x23,x24,
                    x32,x33,x34,
                    x42,x43,x44);

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        store2(Y,i,j,max);
    }
}
// ----------------------------------------------------------------------------------------
void line_ouverture3_ui8matrix_fusion_ilu5_red(uint8 **X, int i, int j0, int j1, uint8 **Y)
// ----------------------------------------------------------------------------------------
{
    uint8   n00,n01,n02,n03,n04,
            n10,n11,n12,n13,n14,
            n20,n21,n22,n23,n24,
            n30,n31,n32,n33,n34,
            n40,n41,n42,n43,n44;

    uint8   z00,z01,z02,
            z10,z11,z12,
            z20,z21,z22;
    uint8 max;

    int j, r = (j1 - j0 + 1) % 5;

    //prologue
        n00 = load2(X,i-2,j0-2);
        n10 = load2(X,i-1,j0-2);
        n20 = load2(X,i  ,j0-2);
        n30 = load2(X,i+1,j0-2);
        n40 = load2(X,i+2,j0-2);
        
        n01 = load2(X,i-2,j0-1);
        n11 = load2(X,i-1,j0-1);
        n21 = load2(X,i  ,j0-1);
        n31 = load2(X,i+1,j0-1);
        n41 = load2(X,i+2,j0-1);
        
        n02 = load2(X,i-2,j0  );
        n12 = load2(X,i-1,j0  );
        n22 = load2(X,i  ,j0  );
        n32 = load2(X,i+1,j0  );
        n42 = load2(X,i+2,j0  );

        n03 = load2(X,i-2,j0+1);
        n13 = load2(X,i-1,j0+1);
        n23 = load2(X,i  ,j0+1);
        n33 = load2(X,i+1,j0+1);
        n43 = load2(X,i+2,j0+1);

        
/*
        n0 = 
        n1 = 
        n2 = 
        n3 = 
        n4 = 

        z0 = 
        z1 = 
        z2 = 

*/
        
        
    //boucle
    for(j = j0 ; j < j1 - r ; j = j + 5 ){
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);
//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);

        
//---------------2-----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        

        store2(Y,i,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);
//------------------3--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       

        store2(Y,i,j+3,max);

        n03 = load2(X,i-2,j+6);
        n13 = load2(X,i-1,j+6);
        n23 = load2(X,i  ,j+6);
        n33 = load2(X,i+1,j+6);
        n43 = load2(X,i+2,j+6);
//-----------------4---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+4,max);
    }

    //epilogue
    switch (r)
    {
        case 1:
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        

        store2(Y,i,j,max);

        break;

        case 2:
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);
//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        break;
    
        case 3:
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);
//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);

        
//---------------2-----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        

        store2(Y,i,j+2,max);

        break;

        case 4:
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);
//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);

        
//---------------2-----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        

        store2(Y,i,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);
//------------------3--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       

        store2(Y,i,j+3,max);

        break;
    }
}
// ---------------------------------------------------------------------------------------------
void line_ouverture3_ui8matrix_fusion_elu2_red(uint8 **X, int i, int j0, int j1, uint8 **Y)
// ----------------------------------------------------------------------------------------
{
    uint8 x[6][5];
    uint8 z[3][3];
    uint8 max;

    for(int j = j0 ; j <= j1 ; j++ ){
        x[0][0]=load2(X,i-2,j-2);
        x[1][0]=load2(X,i-1,j-2);
        x[2][0]=load2(X,i  ,j-2);
        x[3][0]=load2(X,i+1,j-2);
        x[4][0]=load2(X,i+2,j-2);
        x[5][0]=load2(X,i+3,j-2);

        x[0][1]=load2(X,i-2,j-1);
        x[1][1]=load2(X,i-1,j-1);
        x[2][1]=load2(X,i  ,j-1);
        x[3][1]=load2(X,i+1,j-1);
        x[4][1]=load2(X,i+2,j-1);
        x[5][1]=load2(X,i+3,j-1);

        x[0][2]=load2(X,i-2,j  );
        x[1][2]=load2(X,i-1,j  );
        x[2][2]=load2(X,i  ,j  );
        x[3][2]=load2(X,i+1,j  );
        x[4][2]=load2(X,i+2,j  );
        x[5][2]=load2(X,i+3,j  );

        x[0][3]=load2(X,i-2,j+1);
        x[1][3]=load2(X,i-1,j+1);
        x[2][3]=load2(X,i  ,j+1);
        x[3][3]=load2(X,i+1,j+1);
        x[4][3]=load2(X,i+2,j+1);
        x[5][3]=load2(X,i+3,j+1);

        x[0][4]=load2(X,i-2,j+2);
        x[1][4]=load2(X,i-1,j+2);
        x[2][4]=load2(X,i  ,j+2);
        x[3][4]=load2(X,i+1,j+2);
        x[4][4]=load2(X,i+2,j+2);
        x[5][4]=load2(X,i+3,j+2);

        z[0][0]=and9_mat33(x,0,0);
        z[0][1]=and9_mat33(x,0,1);
        z[0][2]=and9_mat33(x,0,2);

        z[1][0]=and9_mat33(x,1,0);
        z[1][1]=and9_mat33(x,1,1);
        z[1][2]=and9_mat33(x,1,2);

        z[2][0]=and9_mat33(x,2,0);
        z[2][1]=and9_mat33(x,2,1);
        z[2][2]=and9_mat33(x,2,2);

        max=or9_mat33(z,0,0);
        store2(Y,i,j,max);

        z[0][0]=and9_mat33(x,1,0);
        z[0][1]=and9_mat33(x,1,1);
        z[0][2]=and9_mat33(x,1,2);

        z[1][0]=and9_mat33(x,2,0);
        z[1][1]=and9_mat33(x,2,1);
        z[1][2]=and9_mat33(x,2,2);

        z[2][0]=and9_mat33(x,3,0);
        z[2][1]=and9_mat33(x,3,1);
        z[2][2]=and9_mat33(x,3,2);

        max=or9_mat33(z,0,0);
        store2(Y,i+1,j,max);
    }
}
// ---------------------------------------------------------------------------------------------
void line_ouverture3_ui8matrix_fusion_ilu5_elu2_red(uint8 **X, int i, int j0, int j1, uint8 **Y)
// ---------------------------------------------------------------------------------------------
{
     uint8  n00,n01,n02,n03,n04,
            n10,n11,n12,n13,n14,
            n20,n21,n22,n23,n24,
            n30,n31,n32,n33,n34,
            n40,n41,n42,n43,n44,
            n50,n51,n52,n53,n54;

    uint8   z00,z01,z02,
            z10,z11,z12,
            z20,z21,z22;

    uint8 max;

    int j, r = (j1 - j0 + 1) % 5;

    //prologue
        n00 = load2(X,i-2,j0-2);
        n10 = load2(X,i-1,j0-2);
        n20 = load2(X,i  ,j0-2);
        n30 = load2(X,i+1,j0-2);
        n40 = load2(X,i+2,j0-2);
        n50 = load2(X,i+3,j0-2);
        
        n01 = load2(X,i-2,j0-1);
        n11 = load2(X,i-1,j0-1);
        n21 = load2(X,i  ,j0-1);
        n31 = load2(X,i+1,j0-1);
        n41 = load2(X,i+2,j0-1);
        n51 = load2(X,i+3,j0-1);
        
        n02 = load2(X,i-2,j0  );
        n12 = load2(X,i-1,j0  );
        n22 = load2(X,i  ,j0  );
        n32 = load2(X,i+1,j0  );
        n42 = load2(X,i+2,j0  );
        n52 = load2(X,i+3,j0  );

        n03 = load2(X,i-2,j0+1);
        n13 = load2(X,i-1,j0+1);
        n23 = load2(X,i  ,j0+1);
        n33 = load2(X,i+1,j0+1);
        n43 = load2(X,i+2,j0+1);
        n53 = load2(X,i+3,j0+1);

    //boucle
    //boucle
    for(j = j0 ; j < j1 - r ; j = j + 5 ){
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
        n54 = load2(X,i+3,j+2);
//-----------------0-0-------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-------------------0-1-------------------
        z00 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z10 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);

        z20 = and9( n30,n31,n32,
                    n40,n41,n42,
                    n50,n51,n52);
//--------------------------------------

        z01 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z11 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);

        z21 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);
//--------------------------------------

        z02 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z12 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        z22 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);
//--------------------------------------
        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i+1,j,max);

//-----------------------1-0--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        n50 = load2(X,i+3,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

//-------------------1-1------------------

        z00 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z10 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);

        z20 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);
//--------------------------------------

        z01 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z11 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        z21 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);
//--------------------------------------

        z02 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z12 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        z22 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i+1,j+1,max);


        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);
        n51 = load2(X,i+3,j+4);
        
//---------------2-0----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        store2(Y,i,j+2,max);

//---------------2-1----------------------

        z00 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z10 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        z20 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);
//--------------------------------------

        z01 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z11 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        z21 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);
//--------------------------------------

        z02 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z12 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);

        z22 = and9( n34,n30,n31,
                    n44,n40,n41,
                    n54,n50,n51);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        store2(Y,i+1,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);
        n52 = load2(X,i+3,j+5);
//------------------3-0--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       
        store2(Y,i,j+3,max);

//------------------3-1--------------------

        z00 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z10 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        z20 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);
//--------------------------------------

        z01 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z11 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);

        z21 = and9( n34,n30,n31,
                    n44,n40,n41,
                    n54,n50,n51);
//--------------------------------------

        z02 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z12 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);

        z22 = and9( n30,n31,n32,
                    n40,n41,n42,
                    n50,n51,n52);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       
        store2(Y,i+1,j+3,max);

        n03 = load2(X,i-2,j+6);
        n13 = load2(X,i-1,j+6);
        n23 = load2(X,i  ,j+6);
        n33 = load2(X,i+1,j+6);
        n43 = load2(X,i+2,j+6);
        n53 = load2(X,i+3,j+6);
//-----------------4-0--------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+4,max);

    //-----------------4-1--------------------

        z00 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z10 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);

        z20 = and9( n34,n30,n31,
                    n44,n40,n41,
                    n54,n50,n51);
//--------------------------------------

        z01 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z11 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);

        z21 = and9( n30,n31,n32,
                    n40,n41,n42,
                    n50,n51,n52);
//--------------------------------------

        z02 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z12 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);

        z22 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i+1,j+4,max);
    }

    //epilogue
    switch (r)
    {
        case 1:
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
        n54 = load2(X,i+3,j+2);
//-----------------0-0-------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-------------------0-1-------------------
        z00 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z10 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);

        z20 = and9( n30,n31,n32,
                    n40,n41,n42,
                    n50,n51,n52);
//--------------------------------------

        z01 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z11 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);

        z21 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);
//--------------------------------------

        z02 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z12 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        z22 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);
//--------------------------------------
        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i+1,j,max);

        break;

        case 2:
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
        n54 = load2(X,i+3,j+2);
//-----------------0-0-------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-------------------0-1-------------------
        z00 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z10 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);

        z20 = and9( n30,n31,n32,
                    n40,n41,n42,
                    n50,n51,n52);
//--------------------------------------

        z01 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z11 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);

        z21 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);
//--------------------------------------

        z02 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z12 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        z22 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);
//--------------------------------------
        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i+1,j,max);

//-----------------------1-0--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        n50 = load2(X,i+3,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

//-------------------1-1------------------

        z00 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z10 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);

        z20 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);
//--------------------------------------

        z01 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z11 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        z21 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);
//--------------------------------------

        z02 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z12 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        z22 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i+1,j+1,max);

        break;
    
        case 3:
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
        n54 = load2(X,i+3,j+2);
//-----------------0-0-------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-------------------0-1-------------------
        z00 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z10 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);

        z20 = and9( n30,n31,n32,
                    n40,n41,n42,
                    n50,n51,n52);
//--------------------------------------

        z01 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z11 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);

        z21 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);
//--------------------------------------

        z02 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z12 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        z22 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);
//--------------------------------------
        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i+1,j,max);

//-----------------------1-0--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        n50 = load2(X,i+3,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

//-------------------1-1------------------

        z00 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z10 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);

        z20 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);
//--------------------------------------

        z01 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z11 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        z21 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);
//--------------------------------------

        z02 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z12 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        z22 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i+1,j+1,max);


        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);
        n51 = load2(X,i+3,j+4);
        
//---------------2-0----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        store2(Y,i,j+2,max);

//---------------2-1----------------------

        z00 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z10 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        z20 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);
//--------------------------------------

        z01 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z11 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        z21 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);
//--------------------------------------

        z02 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z12 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);

        z22 = and9( n34,n30,n31,
                    n44,n40,n41,
                    n54,n50,n51);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        store2(Y,i+1,j+2,max);

        break;

        case 4:
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
        n54 = load2(X,i+3,j+2);
//-----------------0-0-------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-------------------0-1-------------------
        z00 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z10 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);

        z20 = and9( n30,n31,n32,
                    n40,n41,n42,
                    n50,n51,n52);
//--------------------------------------

        z01 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z11 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);

        z21 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);
//--------------------------------------

        z02 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z12 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        z22 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);
//--------------------------------------
        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i+1,j,max);

//-----------------------1-0--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        n50 = load2(X,i+3,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

//-------------------1-1------------------

        z00 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z10 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);

        z20 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);
//--------------------------------------

        z01 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z11 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        z21 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);
//--------------------------------------

        z02 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z12 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        z22 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i+1,j+1,max);


        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);
        n51 = load2(X,i+3,j+4);
        
//---------------2-0----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        store2(Y,i,j+2,max);

//---------------2-1----------------------

        z00 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z10 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        z20 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);
//--------------------------------------

        z01 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z11 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        z21 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);
//--------------------------------------

        z02 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z12 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);

        z22 = and9( n34,n30,n31,
                    n44,n40,n41,
                    n54,n50,n51);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        store2(Y,i+1,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);
        n52 = load2(X,i+3,j+5);
//------------------3-0--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       
        store2(Y,i,j+3,max);

//------------------3-1--------------------

        z00 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z10 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        z20 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);
//--------------------------------------

        z01 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z11 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);

        z21 = and9( n34,n30,n31,
                    n44,n40,n41,
                    n54,n50,n51);
//--------------------------------------

        z02 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z12 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);

        z22 = and9( n30,n31,n32,
                    n40,n41,n42,
                    n50,n51,n52);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       
        store2(Y,i+1,j+3,max);

        break;
    }
}
// ----------------------------------------------------------------------------------------------------
void line_ouverture3_ui8matrix_fusion_ilu5_elu2_red_factor(uint8 **X, int i, int j0, int j1, uint8 **Y)
// ----------------------------------------------------------------------------------------------------
{
    uint8  n00,n01,n02,n03,n04,
           n10,n11,n12,n13,n14,
           n20,n21,n22,n23,n24,
           n30,n31,n32,n33,n34, 
           n40,n41,n42,n43,n44,
           n50,n51,n52,n53,n54;

    uint8   z00,z01,z02,
            z10,z11,z12,
            z20,z21,z22;

    uint8 factor;

    uint8 max;

    int j, r = (j1 - j0 + 1) % 5;

    //prologue
        n00 = load2(X,i-2,j0-2);
        n10 = load2(X,i-1,j0-2);
        n20 = load2(X,i  ,j0-2);
        n30 = load2(X,i+1,j0-2);
        n40 = load2(X,i+2,j0-2);
        n50 = load2(X,i+3,j0-2);
        
        n01 = load2(X,i-2,j0-1);
        n11 = load2(X,i-1,j0-1);
        n21 = load2(X,i  ,j0-1);
        n31 = load2(X,i+1,j0-1);
        n41 = load2(X,i+2,j0-1);
        n51 = load2(X,i+3,j0-1);
        
        n02 = load2(X,i-2,j0  );
        n12 = load2(X,i-1,j0  );
        n22 = load2(X,i  ,j0  );
        n32 = load2(X,i+1,j0  );
        n42 = load2(X,i+2,j0  );
        n52 = load2(X,i+3,j0  );

        n03 = load2(X,i-2,j0+1);
        n13 = load2(X,i-1,j0+1);
        n23 = load2(X,i  ,j0+1);
        n33 = load2(X,i+1,j0+1);
        n43 = load2(X,i+2,j0+1);
        n53 = load2(X,i+3,j0+1);

    //boucle
    for(j = j0 ; j < j1 - r ; j = j + 5 ){
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
        n54 = load2(X,i+3,j+2);

//-----------------calc factor-------------------
        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        factor = or6(z10,z20,z11,z21,z12,z22);

//-----------------0-0-------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        max = or4(z00,z01,z02,factor);

        store2(Y,i,j,max);

//-------------------0-1-------------------

        z20 = and9( n30,n31,n32,
                    n40,n41,n42,
                    n50,n51,n52);

        z21 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);

        z22 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);

        max = or4(z20,z21,z22,factor);

        store2(Y,i+1,j,max);

//-----------------------1-0--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        n50 = load2(X,i+3,j+3);
        
//-----------------calc factor-------------------
        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
                    
        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        factor = or6(z10,z20,z11,z21,z12,z22);
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        max = or4(z00,z01,z02,factor);

        store2(Y,i,j+1,max);

//-------------------1-1------------------

        z20 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);


        z21 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);


        z22 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);


        max = or4(factor,z20,z21,z22);


        store2(Y,i+1,j+1,max);


        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);
        n51 = load2(X,i+3,j+4);
        
//-----------------calc factor-------------------
        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
        
        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
        
        factor = or6(z10,z20,z11,z21,z12,z22);
//---------------2-0----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        max = or4(z00,z01,z02,factor);
        
        store2(Y,i,j+2,max);

//---------------2-1----------------------

        z20 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);

        z21 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);

        z22 = and9( n34,n30,n31,
                    n44,n40,n41,
                    n54,n50,n51);
//--------------------------------------

        max = or4(factor,z20,z21,z22);
        
        store2(Y,i+1,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);
        n52 = load2(X,i+3,j+5);

//-----------------calc factor-------------------
        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
        factor = or6(z10,z20,z11,z21,z12,z22);
//------------------3-0--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        max = or4(z00,z01,z02,factor);
       
        store2(Y,i,j+3,max);

//------------------3-1--------------------


        z20 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);

        z21 = and9( n34,n30,n31,
                    n44,n40,n41,
                    n54,n50,n51);

        z22 = and9( n30,n31,n32,
                    n40,n41,n42,
                    n50,n51,n52);
//--------------------------------------

        max = or4(factor,z20,z21,z22);
       
        store2(Y,i+1,j+3,max);

        n03 = load2(X,i-2,j+6);
        n13 = load2(X,i-1,j+6);
        n23 = load2(X,i  ,j+6);
        n33 = load2(X,i+1,j+6);
        n43 = load2(X,i+2,j+6);
        n53 = load2(X,i+3,j+6);

//-----------------calc factor-------------------
        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);

        factor = or6(z10,z20,z11,z21,z12,z22);

//-----------------4-0--------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

//--------------------------------------

        max = or4(z00,z01,z02,factor);

        store2(Y,i,j+4,max);

    //-----------------4-1--------------------

        z20 = and9( n34,n30,n31,
                    n44,n40,n41,
                    n54,n50,n51);

        z21 = and9( n30,n31,n32,
                    n40,n41,n42,
                    n50,n51,n52);

        z22 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);
//--------------------------------------

        max = or4(factor,z20,z21,z22);

        store2(Y,i+1,j+4,max);
    }

    //epilogue
    switch (r)
    {
        case 1:
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
        n54 = load2(X,i+3,j+2);

//-----------------calc factor-------------------
        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        factor = or6(z10,z20,z11,z21,z12,z22);

//-----------------0-0-------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        max = or4(z00,z01,z02,factor);

        store2(Y,i,j,max);

//-------------------0-1-------------------

        z20 = and9( n30,n31,n32,
                    n40,n41,n42,
                    n50,n51,n52);

        z21 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);

        z22 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);

        max = or4(z20,z21,z22,factor);

        store2(Y,i+1,j,max);

        break;

        case 2:
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
        n54 = load2(X,i+3,j+2);

//-----------------calc factor-------------------
        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        factor = or6(z10,z20,z11,z21,z12,z22);

//-----------------0-0-------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        max = or4(z00,z01,z02,factor);

        store2(Y,i,j,max);

//-------------------0-1-------------------

        z20 = and9( n30,n31,n32,
                    n40,n41,n42,
                    n50,n51,n52);

        z21 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);

        z22 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);

        max = or4(z20,z21,z22,factor);

        store2(Y,i+1,j,max);

//-----------------------1-0--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        n50 = load2(X,i+3,j+3);
        
//-----------------calc factor-------------------
        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
                    
        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        factor = or6(z10,z20,z11,z21,z12,z22);
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        max = or4(z00,z01,z02,factor);

        store2(Y,i,j+1,max);

//-------------------1-1------------------

        z20 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);


        z21 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);


        z22 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);


        max = or4(factor,z20,z21,z22);


        store2(Y,i+1,j+1,max);

        break;
    
        case 3:
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
        n54 = load2(X,i+3,j+2);

//-----------------calc factor-------------------
        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        factor = or6(z10,z20,z11,z21,z12,z22);

//-----------------0-0-------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        max = or4(z00,z01,z02,factor);

        store2(Y,i,j,max);

//-------------------0-1-------------------

        z20 = and9( n30,n31,n32,
                    n40,n41,n42,
                    n50,n51,n52);

        z21 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);

        z22 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);

        max = or4(z20,z21,z22,factor);

        store2(Y,i+1,j,max);

//-----------------------1-0--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        n50 = load2(X,i+3,j+3);
        
//-----------------calc factor-------------------
        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
                    
        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        factor = or6(z10,z20,z11,z21,z12,z22);
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        max = or4(z00,z01,z02,factor);

        store2(Y,i,j+1,max);

//-------------------1-1------------------

        z20 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);


        z21 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);


        z22 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);


        max = or4(factor,z20,z21,z22);


        store2(Y,i+1,j+1,max);


        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);
        n51 = load2(X,i+3,j+4);
        
//-----------------calc factor-------------------
        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
        
        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
        
        factor = or6(z10,z20,z11,z21,z12,z22);
//---------------2-0----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        max = or4(z00,z01,z02,factor);
        
        store2(Y,i,j+2,max);

//---------------2-1----------------------

        z20 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);

        z21 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);

        z22 = and9( n34,n30,n31,
                    n44,n40,n41,
                    n54,n50,n51);
//--------------------------------------

        max = or4(factor,z20,z21,z22);
        
        store2(Y,i+1,j+2,max);

        break;

        case 4:
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
        n54 = load2(X,i+3,j+2);

//-----------------calc factor-------------------
        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        factor = or6(z10,z20,z11,z21,z12,z22);

//-----------------0-0-------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        max = or4(z00,z01,z02,factor);

        store2(Y,i,j,max);

//-------------------0-1-------------------

        z20 = and9( n30,n31,n32,
                    n40,n41,n42,
                    n50,n51,n52);

        z21 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);

        z22 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);

        max = or4(z20,z21,z22,factor);

        store2(Y,i+1,j,max);

//-----------------------1-0--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        n50 = load2(X,i+3,j+3);
        
//-----------------calc factor-------------------
        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
                    
        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        factor = or6(z10,z20,z11,z21,z12,z22);
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        max = or4(z00,z01,z02,factor);

        store2(Y,i,j+1,max);

//-------------------1-1------------------

        z20 = and9( n31,n32,n33,
                    n41,n42,n43,
                    n51,n52,n53);


        z21 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);


        z22 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);


        max = or4(factor,z20,z21,z22);


        store2(Y,i+1,j+1,max);


        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);
        n51 = load2(X,i+3,j+4);
        
//-----------------calc factor-------------------
        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
        
        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
        
        factor = or6(z10,z20,z11,z21,z12,z22);
//---------------2-0----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        max = or4(z00,z01,z02,factor);
        
        store2(Y,i,j+2,max);

//---------------2-1----------------------

        z20 = and9( n32,n33,n34,
                    n42,n43,n44,
                    n52,n53,n54);

        z21 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);

        z22 = and9( n34,n30,n31,
                    n44,n40,n41,
                    n54,n50,n51);
//--------------------------------------

        max = or4(factor,z20,z21,z22);
        
        store2(Y,i+1,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);
        n52 = load2(X,i+3,j+5);

//-----------------calc factor-------------------
        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
        factor = or6(z10,z20,z11,z21,z12,z22);
//------------------3-0--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        max = or4(z00,z01,z02,factor);
       
        store2(Y,i,j+3,max);

//------------------3-1--------------------


        z20 = and9( n33,n34,n30,
                    n43,n44,n40,
                    n53,n54,n50);

        z21 = and9( n34,n30,n31,
                    n44,n40,n41,
                    n54,n50,n51);

        z22 = and9( n30,n31,n32,
                    n40,n41,n42,
                    n50,n51,n52);
//--------------------------------------

        max = or4(factor,z20,z21,z22);
       
        store2(Y,i+1,j+3,max);

        break;
    }
}
// -----------------------------------------------------------------------------------------
void line_ouverture3_ui8matrix_fusion_ilu15_red(uint8 **X, int i, int j0, int j1, uint8 **Y)
// -----------------------------------------------------------------------------------------
{
    uint8   n00,n01,n02,n03,n04,
            n10,n11,n12,n13,n14,
            n20,n21,n22,n23,n24,
            n30,n31,n32,n33,n34,
            n40,n41,n42,n43,n44;

    uint8   z00,z01,z02,
            z10,z11,z12,
            z20,z21,z22;
    uint8 max;

    int j, r = (j1 - j0 + 1) % 15;

    //prologue
        n00 = load2(X,i-2,j0-2);
        n10 = load2(X,i-1,j0-2);
        n20 = load2(X,i  ,j0-2);
        n30 = load2(X,i+1,j0-2);
        n40 = load2(X,i+2,j0-2);
        
        n01 = load2(X,i-2,j0-1);
        n11 = load2(X,i-1,j0-1);
        n21 = load2(X,i  ,j0-1);
        n31 = load2(X,i+1,j0-1);
        n41 = load2(X,i+2,j0-1);
        
        n02 = load2(X,i-2,j0  );
        n12 = load2(X,i-1,j0  );
        n22 = load2(X,i  ,j0  );
        n32 = load2(X,i+1,j0  );
        n42 = load2(X,i+2,j0  );

        n03 = load2(X,i-2,j0+1);
        n13 = load2(X,i-1,j0+1);
        n23 = load2(X,i  ,j0+1);
        n33 = load2(X,i+1,j0+1);
        n43 = load2(X,i+2,j0+1);

        
/*
        n0 = 
        n1 = 
        n2 = 
        n3 = 
        n4 = 

        z0 = 
        z1 = 
        z2 = 

*/
        
        
    //boucle
    for(j = j0 ; j < j1 - r ; j = j + 15 ){
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);

        
//---------------2-----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        

        store2(Y,i,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);

//------------------3--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       

        store2(Y,i,j+3,max);

        n03 = load2(X,i-2,j+6);
        n13 = load2(X,i-1,j+6);
        n23 = load2(X,i  ,j+6);
        n33 = load2(X,i+1,j+6);
        n43 = load2(X,i+2,j+6);
//-----------------4---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+4,max);

        n04 = load2(X,i-2,j+7);
        n14 = load2(X,i-1,j+7);
        n24 = load2(X,i  ,j+7);
        n34 = load2(X,i+1,j+7);
        n44 = load2(X,i+2,j+7);
//-----------------5---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+5,max);
    
        n00 = load2(X,i-2,j+8);
        n10 = load2(X,i-1,j+8);
        n20 = load2(X,i  ,j+8);
        n30 = load2(X,i+1,j+8);
        n40 = load2(X,i+2,j+8);
//-----------------6---------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+6,max);

        n01 = load2(X,i-2,j+9);
        n11 = load2(X,i-1,j+9);
        n21 = load2(X,i  ,j+9);
        n31 = load2(X,i+1,j+9);
        n41 = load2(X,i+2,j+9);

//-----------------7---------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+7,max);

        n02 = load2(X,i-2,j+10);
        n12 = load2(X,i-1,j+10);
        n22 = load2(X,i  ,j+10);
        n32 = load2(X,i+1,j+10);
        n42 = load2(X,i+2,j+10);

//-----------------8---------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n01,n00,n01,
                    n11,n10,n11,
                    n21,n20,n21);

        z11 = and9( n11,n10,n11,
                    n21,n20,n21,
                    n31,n30,n31);

        z21 = and9( n21,n20,n21,
                    n31,n30,n31,
                    n41,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+8,max);

        n03 = load2(X,i-2,j+11);
        n13 = load2(X,i-1,j+11);
        n23 = load2(X,i  ,j+11);
        n33 = load2(X,i+1,j+11);
        n43 = load2(X,i+2,j+11);

//-----------------9---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+9,max);

        n04 = load2(X,i-2,j+12);
        n14 = load2(X,i-1,j+12);
        n24 = load2(X,i  ,j+12);
        n34 = load2(X,i+1,j+12);
        n44 = load2(X,i+2,j+12);

//-----------------10---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+10,max);

        n00 = load2(X,i-2,j+13);
        n10 = load2(X,i-1,j+13);
        n20 = load2(X,i  ,j+13);
        n30 = load2(X,i+1,j+13);
        n40 = load2(X,i+2,j+13);

//-----------------11---------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+11,max);

        n01 = load2(X,i-2,j+14);
        n11 = load2(X,i-1,j+14);
        n21 = load2(X,i  ,j+14);
        n31 = load2(X,i+1,j+14);
        n41 = load2(X,i+2,j+14);
//-----------------12---------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+12,max);

        n02 = load2(X,i-2,j+15);
        n12 = load2(X,i-1,j+15);
        n22 = load2(X,i  ,j+15);
        n32 = load2(X,i+1,j+15);
        n42 = load2(X,i+2,j+15);
//-----------------13---------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+13,max);

        n03 = load2(X,i-2,j+16);
        n13 = load2(X,i-1,j+16);
        n23 = load2(X,i  ,j+16);
        n33 = load2(X,i+1,j+16);
        n43 = load2(X,i+2,j+16);
//-----------------14-------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//-----------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//-----------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+14,max);
    }

    //epilogue
    switch (r)
    {
        case 1:
        
                n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

        break;

        case 2:

        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        break;
    
        case 3:
        
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);

        
//---------------2-----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        

        store2(Y,i,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);

        break;

        case 4:

        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);

        
//---------------2-----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        

        store2(Y,i,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);

//------------------3--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       

        store2(Y,i,j+3,max);
        
        break;

        case 5:

        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);

        
//---------------2-----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        

        store2(Y,i,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);

//------------------3--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       

        store2(Y,i,j+3,max);

        n03 = load2(X,i-2,j+6);
        n13 = load2(X,i-1,j+6);
        n23 = load2(X,i  ,j+6);
        n33 = load2(X,i+1,j+6);
        n43 = load2(X,i+2,j+6);
//-----------------4---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+4,max);
        
        break;

        case 6:

        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);

        
//---------------2-----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        

        store2(Y,i,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);

//------------------3--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       

        store2(Y,i,j+3,max);

        n03 = load2(X,i-2,j+6);
        n13 = load2(X,i-1,j+6);
        n23 = load2(X,i  ,j+6);
        n33 = load2(X,i+1,j+6);
        n43 = load2(X,i+2,j+6);
//-----------------4---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+4,max);

        n04 = load2(X,i-2,j+7);
        n14 = load2(X,i-1,j+7);
        n24 = load2(X,i  ,j+7);
        n34 = load2(X,i+1,j+7);
        n44 = load2(X,i+2,j+7);
//-----------------5---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+5,max);
    
        break;

        case 7:

        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);

        
//---------------2-----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        

        store2(Y,i,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);

//------------------3--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       

        store2(Y,i,j+3,max);

        n03 = load2(X,i-2,j+6);
        n13 = load2(X,i-1,j+6);
        n23 = load2(X,i  ,j+6);
        n33 = load2(X,i+1,j+6);
        n43 = load2(X,i+2,j+6);
//-----------------4---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+4,max);

        n04 = load2(X,i-2,j+7);
        n14 = load2(X,i-1,j+7);
        n24 = load2(X,i  ,j+7);
        n34 = load2(X,i+1,j+7);
        n44 = load2(X,i+2,j+7);
//-----------------5---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+5,max);
    
        n00 = load2(X,i-2,j+8);
        n10 = load2(X,i-1,j+8);
        n20 = load2(X,i  ,j+8);
        n30 = load2(X,i+1,j+8);
        n40 = load2(X,i+2,j+8);
//-----------------6---------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+6,max);
        
        break;

        case 8:

        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);

        
//---------------2-----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        

        store2(Y,i,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);

//------------------3--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       

        store2(Y,i,j+3,max);

        n03 = load2(X,i-2,j+6);
        n13 = load2(X,i-1,j+6);
        n23 = load2(X,i  ,j+6);
        n33 = load2(X,i+1,j+6);
        n43 = load2(X,i+2,j+6);
//-----------------4---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+4,max);

        n04 = load2(X,i-2,j+7);
        n14 = load2(X,i-1,j+7);
        n24 = load2(X,i  ,j+7);
        n34 = load2(X,i+1,j+7);
        n44 = load2(X,i+2,j+7);
//-----------------5---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+5,max);
    
        n00 = load2(X,i-2,j+8);
        n10 = load2(X,i-1,j+8);
        n20 = load2(X,i  ,j+8);
        n30 = load2(X,i+1,j+8);
        n40 = load2(X,i+2,j+8);
//-----------------6---------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+6,max);

        n01 = load2(X,i-2,j+9);
        n11 = load2(X,i-1,j+9);
        n21 = load2(X,i  ,j+9);
        n31 = load2(X,i+1,j+9);
        n41 = load2(X,i+2,j+9);

//-----------------7---------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+7,max);

        
        break;

        case 9:

        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);

        
//---------------2-----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        

        store2(Y,i,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);

//------------------3--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       

        store2(Y,i,j+3,max);

        n03 = load2(X,i-2,j+6);
        n13 = load2(X,i-1,j+6);
        n23 = load2(X,i  ,j+6);
        n33 = load2(X,i+1,j+6);
        n43 = load2(X,i+2,j+6);
//-----------------4---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+4,max);

        n04 = load2(X,i-2,j+7);
        n14 = load2(X,i-1,j+7);
        n24 = load2(X,i  ,j+7);
        n34 = load2(X,i+1,j+7);
        n44 = load2(X,i+2,j+7);
//-----------------5---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+5,max);
    
        n00 = load2(X,i-2,j+8);
        n10 = load2(X,i-1,j+8);
        n20 = load2(X,i  ,j+8);
        n30 = load2(X,i+1,j+8);
        n40 = load2(X,i+2,j+8);
//-----------------6---------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+6,max);

        n01 = load2(X,i-2,j+9);
        n11 = load2(X,i-1,j+9);
        n21 = load2(X,i  ,j+9);
        n31 = load2(X,i+1,j+9);
        n41 = load2(X,i+2,j+9);

//-----------------7---------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+7,max);

        n02 = load2(X,i-2,j+10);
        n12 = load2(X,i-1,j+10);
        n22 = load2(X,i  ,j+10);
        n32 = load2(X,i+1,j+10);
        n42 = load2(X,i+2,j+10);

//-----------------8---------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n01,n00,n01,
                    n11,n10,n11,
                    n21,n20,n21);

        z11 = and9( n11,n10,n11,
                    n21,n20,n21,
                    n31,n30,n31);

        z21 = and9( n21,n20,n21,
                    n31,n30,n31,
                    n41,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+8,max);
        
        break;

        case 10:

        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);

        
//---------------2-----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        

        store2(Y,i,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);

//------------------3--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       

        store2(Y,i,j+3,max);

        n03 = load2(X,i-2,j+6);
        n13 = load2(X,i-1,j+6);
        n23 = load2(X,i  ,j+6);
        n33 = load2(X,i+1,j+6);
        n43 = load2(X,i+2,j+6);
//-----------------4---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+4,max);

        n04 = load2(X,i-2,j+7);
        n14 = load2(X,i-1,j+7);
        n24 = load2(X,i  ,j+7);
        n34 = load2(X,i+1,j+7);
        n44 = load2(X,i+2,j+7);
//-----------------5---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+5,max);
    
        n00 = load2(X,i-2,j+8);
        n10 = load2(X,i-1,j+8);
        n20 = load2(X,i  ,j+8);
        n30 = load2(X,i+1,j+8);
        n40 = load2(X,i+2,j+8);
//-----------------6---------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+6,max);

        n01 = load2(X,i-2,j+9);
        n11 = load2(X,i-1,j+9);
        n21 = load2(X,i  ,j+9);
        n31 = load2(X,i+1,j+9);
        n41 = load2(X,i+2,j+9);

//-----------------7---------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+7,max);

        n02 = load2(X,i-2,j+10);
        n12 = load2(X,i-1,j+10);
        n22 = load2(X,i  ,j+10);
        n32 = load2(X,i+1,j+10);
        n42 = load2(X,i+2,j+10);

//-----------------8---------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n01,n00,n01,
                    n11,n10,n11,
                    n21,n20,n21);

        z11 = and9( n11,n10,n11,
                    n21,n20,n21,
                    n31,n30,n31);

        z21 = and9( n21,n20,n21,
                    n31,n30,n31,
                    n41,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+8,max);

        n03 = load2(X,i-2,j+11);
        n13 = load2(X,i-1,j+11);
        n23 = load2(X,i  ,j+11);
        n33 = load2(X,i+1,j+11);
        n43 = load2(X,i+2,j+11);

//-----------------9---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+9,max);
        
        break;

        case 11:

        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);

        
//---------------2-----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        

        store2(Y,i,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);

//------------------3--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       

        store2(Y,i,j+3,max);

        n03 = load2(X,i-2,j+6);
        n13 = load2(X,i-1,j+6);
        n23 = load2(X,i  ,j+6);
        n33 = load2(X,i+1,j+6);
        n43 = load2(X,i+2,j+6);
//-----------------4---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+4,max);

        n04 = load2(X,i-2,j+7);
        n14 = load2(X,i-1,j+7);
        n24 = load2(X,i  ,j+7);
        n34 = load2(X,i+1,j+7);
        n44 = load2(X,i+2,j+7);
//-----------------5---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+5,max);
    
        n00 = load2(X,i-2,j+8);
        n10 = load2(X,i-1,j+8);
        n20 = load2(X,i  ,j+8);
        n30 = load2(X,i+1,j+8);
        n40 = load2(X,i+2,j+8);
//-----------------6---------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+6,max);

        n01 = load2(X,i-2,j+9);
        n11 = load2(X,i-1,j+9);
        n21 = load2(X,i  ,j+9);
        n31 = load2(X,i+1,j+9);
        n41 = load2(X,i+2,j+9);

//-----------------7---------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+7,max);

        n02 = load2(X,i-2,j+10);
        n12 = load2(X,i-1,j+10);
        n22 = load2(X,i  ,j+10);
        n32 = load2(X,i+1,j+10);
        n42 = load2(X,i+2,j+10);

//-----------------8---------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n01,n00,n01,
                    n11,n10,n11,
                    n21,n20,n21);

        z11 = and9( n11,n10,n11,
                    n21,n20,n21,
                    n31,n30,n31);

        z21 = and9( n21,n20,n21,
                    n31,n30,n31,
                    n41,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+8,max);

        n03 = load2(X,i-2,j+11);
        n13 = load2(X,i-1,j+11);
        n23 = load2(X,i  ,j+11);
        n33 = load2(X,i+1,j+11);
        n43 = load2(X,i+2,j+11);

//-----------------9---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+9,max);

        n04 = load2(X,i-2,j+12);
        n14 = load2(X,i-1,j+12);
        n24 = load2(X,i  ,j+12);
        n34 = load2(X,i+1,j+12);
        n44 = load2(X,i+2,j+12);

//-----------------10---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+10,max);
        
        break;

        case 12:

        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);

        
//---------------2-----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        

        store2(Y,i,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);

//------------------3--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       

        store2(Y,i,j+3,max);

        n03 = load2(X,i-2,j+6);
        n13 = load2(X,i-1,j+6);
        n23 = load2(X,i  ,j+6);
        n33 = load2(X,i+1,j+6);
        n43 = load2(X,i+2,j+6);
//-----------------4---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+4,max);

        n04 = load2(X,i-2,j+7);
        n14 = load2(X,i-1,j+7);
        n24 = load2(X,i  ,j+7);
        n34 = load2(X,i+1,j+7);
        n44 = load2(X,i+2,j+7);
//-----------------5---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+5,max);
    
        n00 = load2(X,i-2,j+8);
        n10 = load2(X,i-1,j+8);
        n20 = load2(X,i  ,j+8);
        n30 = load2(X,i+1,j+8);
        n40 = load2(X,i+2,j+8);
//-----------------6---------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+6,max);

        n01 = load2(X,i-2,j+9);
        n11 = load2(X,i-1,j+9);
        n21 = load2(X,i  ,j+9);
        n31 = load2(X,i+1,j+9);
        n41 = load2(X,i+2,j+9);

//-----------------7---------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+7,max);

        n02 = load2(X,i-2,j+10);
        n12 = load2(X,i-1,j+10);
        n22 = load2(X,i  ,j+10);
        n32 = load2(X,i+1,j+10);
        n42 = load2(X,i+2,j+10);

//-----------------8---------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n01,n00,n01,
                    n11,n10,n11,
                    n21,n20,n21);

        z11 = and9( n11,n10,n11,
                    n21,n20,n21,
                    n31,n30,n31);

        z21 = and9( n21,n20,n21,
                    n31,n30,n31,
                    n41,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+8,max);

        n03 = load2(X,i-2,j+11);
        n13 = load2(X,i-1,j+11);
        n23 = load2(X,i  ,j+11);
        n33 = load2(X,i+1,j+11);
        n43 = load2(X,i+2,j+11);

//-----------------9---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+9,max);

        n04 = load2(X,i-2,j+12);
        n14 = load2(X,i-1,j+12);
        n24 = load2(X,i  ,j+12);
        n34 = load2(X,i+1,j+12);
        n44 = load2(X,i+2,j+12);

//-----------------10---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+10,max);

        n00 = load2(X,i-2,j+13);
        n10 = load2(X,i-1,j+13);
        n20 = load2(X,i  ,j+13);
        n30 = load2(X,i+1,j+13);
        n40 = load2(X,i+2,j+13);

//-----------------11---------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+11,max);

        
        break;

        case 13:

        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);

        
//---------------2-----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        

        store2(Y,i,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);

//------------------3--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       

        store2(Y,i,j+3,max);

        n03 = load2(X,i-2,j+6);
        n13 = load2(X,i-1,j+6);
        n23 = load2(X,i  ,j+6);
        n33 = load2(X,i+1,j+6);
        n43 = load2(X,i+2,j+6);
//-----------------4---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+4,max);

        n04 = load2(X,i-2,j+7);
        n14 = load2(X,i-1,j+7);
        n24 = load2(X,i  ,j+7);
        n34 = load2(X,i+1,j+7);
        n44 = load2(X,i+2,j+7);
//-----------------5---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+5,max);
    
        n00 = load2(X,i-2,j+8);
        n10 = load2(X,i-1,j+8);
        n20 = load2(X,i  ,j+8);
        n30 = load2(X,i+1,j+8);
        n40 = load2(X,i+2,j+8);
//-----------------6---------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+6,max);

        n01 = load2(X,i-2,j+9);
        n11 = load2(X,i-1,j+9);
        n21 = load2(X,i  ,j+9);
        n31 = load2(X,i+1,j+9);
        n41 = load2(X,i+2,j+9);

//-----------------7---------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+7,max);

        n02 = load2(X,i-2,j+10);
        n12 = load2(X,i-1,j+10);
        n22 = load2(X,i  ,j+10);
        n32 = load2(X,i+1,j+10);
        n42 = load2(X,i+2,j+10);

//-----------------8---------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n01,n00,n01,
                    n11,n10,n11,
                    n21,n20,n21);

        z11 = and9( n11,n10,n11,
                    n21,n20,n21,
                    n31,n30,n31);

        z21 = and9( n21,n20,n21,
                    n31,n30,n31,
                    n41,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+8,max);

        n03 = load2(X,i-2,j+11);
        n13 = load2(X,i-1,j+11);
        n23 = load2(X,i  ,j+11);
        n33 = load2(X,i+1,j+11);
        n43 = load2(X,i+2,j+11);

//-----------------9---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+9,max);

        n04 = load2(X,i-2,j+12);
        n14 = load2(X,i-1,j+12);
        n24 = load2(X,i  ,j+12);
        n34 = load2(X,i+1,j+12);
        n44 = load2(X,i+2,j+12);

//-----------------10---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+10,max);

        n00 = load2(X,i-2,j+13);
        n10 = load2(X,i-1,j+13);
        n20 = load2(X,i  ,j+13);
        n30 = load2(X,i+1,j+13);
        n40 = load2(X,i+2,j+13);

//-----------------11---------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+11,max);

        n01 = load2(X,i-2,j+14);
        n11 = load2(X,i-1,j+14);
        n21 = load2(X,i  ,j+14);
        n31 = load2(X,i+1,j+14);
        n41 = load2(X,i+2,j+14);
//-----------------12---------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+12,max);
        
        break;

        case 14:
        
        n04 = load2(X,i-2,j+2);
        n14 = load2(X,i-1,j+2);
        n24 = load2(X,i  ,j+2);
        n34 = load2(X,i+1,j+2);
        n44 = load2(X,i+2,j+2);
//-----------------0---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j,max);

//-----------------------1--------------------
        n00 = load2(X,i-2,j+3);
        n10 = load2(X,i-1,j+3);
        n20 = load2(X,i  ,j+3);
        n30 = load2(X,i+1,j+3);
        n40 = load2(X,i+2,j+3);
        
//--------------------------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);


        store2(Y,i,j+1,max);

        n01 = load2(X,i-2,j+4);
        n11 = load2(X,i-1,j+4);
        n21 = load2(X,i  ,j+4);
        n31 = load2(X,i+1,j+4);
        n41 = load2(X,i+2,j+4);

        
//---------------2-----------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
        
        

        store2(Y,i,j+2,max);

        n02 = load2(X,i-2,j+5);
        n12 = load2(X,i-1,j+5);
        n22 = load2(X,i  ,j+5);
        n32 = load2(X,i+1,j+5);
        n42 = load2(X,i+2,j+5);

//------------------3--------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);
       

        store2(Y,i,j+3,max);

        n03 = load2(X,i-2,j+6);
        n13 = load2(X,i-1,j+6);
        n23 = load2(X,i  ,j+6);
        n33 = load2(X,i+1,j+6);
        n43 = load2(X,i+2,j+6);
//-----------------4---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+4,max);

        n04 = load2(X,i-2,j+7);
        n14 = load2(X,i-1,j+7);
        n24 = load2(X,i  ,j+7);
        n34 = load2(X,i+1,j+7);
        n44 = load2(X,i+2,j+7);
//-----------------5---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+5,max);
    
        n00 = load2(X,i-2,j+8);
        n10 = load2(X,i-1,j+8);
        n20 = load2(X,i  ,j+8);
        n30 = load2(X,i+1,j+8);
        n40 = load2(X,i+2,j+8);
//-----------------6---------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+6,max);

        n01 = load2(X,i-2,j+9);
        n11 = load2(X,i-1,j+9);
        n21 = load2(X,i  ,j+9);
        n31 = load2(X,i+1,j+9);
        n41 = load2(X,i+2,j+9);

//-----------------7---------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+7,max);

        n02 = load2(X,i-2,j+10);
        n12 = load2(X,i-1,j+10);
        n22 = load2(X,i  ,j+10);
        n32 = load2(X,i+1,j+10);
        n42 = load2(X,i+2,j+10);

//-----------------8---------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n01,n00,n01,
                    n11,n10,n11,
                    n21,n20,n21);

        z11 = and9( n11,n10,n11,
                    n21,n20,n21,
                    n31,n30,n31);

        z21 = and9( n21,n20,n21,
                    n31,n30,n31,
                    n41,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+8,max);

        n03 = load2(X,i-2,j+11);
        n13 = load2(X,i-1,j+11);
        n23 = load2(X,i  ,j+11);
        n33 = load2(X,i+1,j+11);
        n43 = load2(X,i+2,j+11);

//-----------------9---------------------

        z00 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z10 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z20 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z01 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z11 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z21 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z02 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z12 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z22 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+9,max);

        n04 = load2(X,i-2,j+12);
        n14 = load2(X,i-1,j+12);
        n24 = load2(X,i  ,j+12);
        n34 = load2(X,i+1,j+12);
        n44 = load2(X,i+2,j+12);

//-----------------10---------------------

        z00 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z10 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z20 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        z01 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z11 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z21 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z02 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z12 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z22 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+10,max);

        n00 = load2(X,i-2,j+13);
        n10 = load2(X,i-1,j+13);
        n20 = load2(X,i  ,j+13);
        n30 = load2(X,i+1,j+13);
        n40 = load2(X,i+2,j+13);

//-----------------11---------------------

        z00 = and9( n01,n02,n03,
                    n11,n12,n13,
                    n21,n22,n23);

        z10 = and9( n11,n12,n13,
                    n21,n22,n23,
                    n31,n32,n33);

        z20 = and9( n21,n22,n23,
                    n31,n32,n33,
                    n41,n42,n43);
//--------------------------------------

        z01 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z11 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z21 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z02 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z12 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z22 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+11,max);

        n01 = load2(X,i-2,j+14);
        n11 = load2(X,i-1,j+14);
        n21 = load2(X,i  ,j+14);
        n31 = load2(X,i+1,j+14);
        n41 = load2(X,i+2,j+14);
//-----------------12---------------------

        z00 = and9( n02,n03,n04,
                    n12,n13,n14,
                    n22,n23,n24);

        z10 = and9( n12,n13,n14,
                    n22,n23,n24,
                    n32,n33,n34);

        z20 = and9( n22,n23,n24,
                    n32,n33,n34,
                    n42,n43,n44);
//--------------------------------------

        z01 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z11 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z21 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z02 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z12 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z22 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+12,max);

        n02 = load2(X,i-2,j+15);
        n12 = load2(X,i-1,j+15);
        n22 = load2(X,i  ,j+15);
        n32 = load2(X,i+1,j+15);
        n42 = load2(X,i+2,j+15);
//-----------------13---------------------

        z00 = and9( n03,n04,n00,
                    n13,n14,n10,
                    n23,n24,n20);

        z10 = and9( n13,n14,n10,
                    n23,n24,n20,
                    n33,n34,n30);

        z20 = and9( n23,n24,n20,
                    n33,n34,n30,
                    n43,n44,n40);
//--------------------------------------

        z01 = and9( n04,n00,n01,
                    n14,n10,n11,
                    n24,n20,n21);

        z11 = and9( n14,n10,n11,
                    n24,n20,n21,
                    n34,n30,n31);

        z21 = and9( n24,n20,n21,
                    n34,n30,n31,
                    n44,n40,n41);
//--------------------------------------

        z02 = and9( n00,n01,n02,
                    n10,n11,n12,
                    n20,n21,n22);

        z12 = and9( n10,n11,n12,
                    n20,n21,n22,
                    n30,n31,n32);

        z22 = and9( n20,n21,n22,
                    n30,n31,n32,
                    n40,n41,n42);
//--------------------------------------

        max = or9(z00,z01,z02,z10,z11,z12,z20,z21,z22);

        store2(Y,i,j+13,max);

        break;
    }
}
// ---------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_basic(uint8 **X, int i0, int i1, int j0, int j1, uint8 **Y, uint8 **Z)
// ---------------------------------------------------------------------------------------------
{
    erosion3_ui8matrix_basic(X, i0-1, i1+1, j0-1, j1+1, Y);
    dilatation3_ui8matrix_basic(Y, i0,   i1,   j0,   j1,   Z);
}
// -----------------------------------------------------------------------------------------
void ouverture3_ui8matrix_fusion_basic(uint8 **X, int i0, int i1, int j0, int j1, uint8 **Y)
// -----------------------------------------------------------------------------------------
{
    for(int i = i0; i <= i1 ; i++ ){
        line_ouverture3_ui8matrix_fusion_basic(X, i, j0, j1, Y);
    }
}
// ---------------------------------------------------------------------------------------
void ouverture3_ui8matrix_fusion_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **Y)
// ---------------------------------------------------------------------------------------
{
    for(int i = i0; i <= i1 ; i++ ){
        line_ouverture3_ui8matrix_fusion_red(X, i, j0, j1, Y);
    }
}
// --------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_fusion_ilu5_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **Y)
// --------------------------------------------------------------------------------------------
{
    for(int i = i0; i <= i1 ; i++ ){
        line_ouverture3_ui8matrix_fusion_ilu5_red(X, i, j0, j1, Y);
    }
}
// ---------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_fusion_ilu15_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **Y)
// ---------------------------------------------------------------------------------------------
{
    for(int i = i0; i <= i1 ; i++ ){
        line_ouverture3_ui8matrix_fusion_ilu15_red(X, i, j0, j1, Y);
    }
}
// --------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_fusion_elu2_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **Y)
// --------------------------------------------------------------------------------------------
{
    int i, r = (i1 - i0 + 1)%2;
    for(int i = i0; i <= i1-r ; i+=2 ){
        line_ouverture3_ui8matrix_fusion_elu2_red(X, i, j0, j1, Y);
    }
    if(r){
        line_ouverture3_ui8matrix_fusion_basic(X, i, j0, j1, Y);
    }
}
// -------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_fusion_ilu5_elu2_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **Y)
// -------------------------------------------------------------------------------------------------
{
    int i, r = (i1 - i0 + 1)%2;
    for(int i = i0; i <= i1-r ; i+=2 ){
        line_ouverture3_ui8matrix_fusion_ilu5_elu2_red(X, i, j0, j1, Y);
    }
    if(r){
        line_ouverture3_ui8matrix_fusion_basic(X, i, j0, j1, Y);
    }
}
// --------------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_fusion_ilu5_elu2_red_factor(uint8 **X, int i0, int i1, int j0, int j1, uint8 **Y)
// --------------------------------------------------------------------------------------------------------
{
    int i, r = (i1 - i0 + 1)%2;
    for(int i = i0; i <= i1-r ; i+=2 ){
        line_ouverture3_ui8matrix_fusion_ilu5_elu2_red_factor(X, i, j0, j1, Y);
    }
    if(r){
        line_ouverture3_ui8matrix_fusion_basic(X, i, j0, j1, Y);
    }
}
// ------------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_pipeline_basic(uint8 **X, int i0, int i1, int j0, int j1, uint8 **T, uint8 **Y)
// ------------------------------------------------------------------------------------------------------
{
    //prologue pipeline
    line_erosion3_ui8matrix_basic(X,i0-1,j0-1,j1+1,T);
    line_erosion3_ui8matrix_basic(X,i0  ,j0-1,j1+1,T);

    //pipeline
    for(int i = i0; i <= i1-1; i++){
        line_erosion3_ui8matrix_basic(X,i+1,j0-1,j1+1,T);
        line_dilatation3_ui8matrix_basic(T,i  ,j0  ,j1  ,Y);
    }

    //epilogue pipeline
    line_dilatation3_ui8matrix_basic(T,i1  ,j0  ,j1  ,Y);
}
// ----------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_pipeline_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **T, uint8 **Y)
// ----------------------------------------------------------------------------------------------------
{
    //prologue pipeline
    line_erosion3_ui8matrix_red(X,i0-1,j0-1,j1+1,T);
    line_erosion3_ui8matrix_red(X,i0  ,j0-1,j1+1,T);

    //pipeline
    for(int i = i0; i <= i1-1; i++){
        line_erosion3_ui8matrix_red(X,i+1,j0-1,j1+1,T);
        line_dilatation3_ui8matrix_red(T,i  ,j0  ,j1  ,Y);
    }

    //epilogue pipeline
    line_dilatation3_ui8matrix_red(T,i1  ,j0  ,j1  ,Y);
}
// ---------------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_pipeline_ilu3_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **T, uint8 **Y)
// ---------------------------------------------------------------------------------------------------------
{
    //prologue pipeline
    line_erosion3_ui8matrix_ilu3_red(X,i0-1,j0-1,j1+1,T);
    line_erosion3_ui8matrix_ilu3_red(X,i0  ,j0-1,j1+1,T);

    //pipeline
    for(int i = i0; i <= i1-1; i++){
        line_erosion3_ui8matrix_ilu3_red(X,i+1,j0-1,j1+1,T);
        line_dilatation3_ui8matrix_ilu3_red(T,i  ,j0  ,j1  ,Y);
    }

    //epilogue pipeline
    line_dilatation3_ui8matrix_ilu3_red(T,i1  ,j0  ,j1  ,Y);
}
// ---------------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_pipeline_elu2_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **T, uint8 **Y)
// ---------------------------------------------------------------------------------------------------------
{
    //prologue pipeline

    line_erosion3_ui8matrix_elu2_red(X,i0-1,j0-1,j1+1,T);

    //pipeline
    int r = (i1-i0+1)%2;
    for(int i = i0; i <= i1-r; i+=2){

        line_erosion3_ui8matrix_elu2_red(X,i+1,j0-1,j1+1,T);

        line_dilatation3_ui8matrix_elu2_red(T,i  ,j0  ,j1  ,Y);

    }

    //epilogue pipeline
        if(r){

            line_dilatation3_ui8matrix_ilu3_red(T,i1,j0  ,j1  ,Y);
        }
}
// ----------------------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_pipeline_elu2_red_factor(uint8 **X, int i0, int i1, int j0, int j1, uint8 **T, uint8 **Y)
// ----------------------------------------------------------------------------------------------------------------
{
    //prologue pipeline
    line_erosion3_ui8matrix_elu2_red_factor(X,i0-1,j0-1,j1+1,T);

    //pipeline
    int r = (i1-i0+1)%2;
    for(int i = i0; i <= i1-r; i+=2){

        line_erosion3_ui8matrix_elu2_red_factor(X,i+1,j0-1,j1+1,T);
        line_dilatation3_ui8matrix_elu2_red_factor(T,i  ,j0  ,j1  ,Y);
    }

    //epilogue pipeline
        if(r){
            line_dilatation3_ui8matrix_ilu3_red(T,i1,j0  ,j1  ,Y);
        }
}
// --------------------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_pipeline_ilu3_elu2_red(uint8 **X, int i0, int i1, int j0, int j1, uint8 **T, uint8 **Y)
// --------------------------------------------------------------------------------------------------------------
{
    //prologue pipeline
    line_erosion3_ui8matrix_ilu3_elu2_red(X,i0-1,j0-1,j1+1,T);

    //pipeline
    int r = (i1-i0+1)%2;
    for(int i = i0; i <= i1-r; i+=2){

        line_erosion3_ui8matrix_ilu3_elu2_red(X,i+1,j0-1,j1+1,T);
        line_dilatation3_ui8matrix_ilu3_elu2_red(T,i  ,j0  ,j1  ,Y);
    }

    //epilogue pipeline
        if(r){
            line_dilatation3_ui8matrix_ilu3_red(T,i1,j0  ,j1  ,Y);
        }
}
// ---------------------------------------------------------------------------------------------------------------------
void ouverture3_ui8matrix_pipeline_ilu3_elu2_red_factor(uint8 **X, int i0, int i1, int j0, int j1, uint8 **T, uint8 **Y)
// ---------------------------------------------------------------------------------------------------------------------
{
    //prologue pipeline

    line_erosion3_ui8matrix_ilu3_elu2_red_factor(X,i0-1,j0-1,j1+1,T);

    //pipeline
    int r = (i1-i0+1)%2;
    for(int i = i0; i <= i1-r; i+=2){

        line_erosion3_ui8matrix_ilu3_elu2_red_factor(X,i+1,j0-1,j1+1,T);

        line_dilatation3_ui8matrix_ilu3_elu2_red_factor(T,i  ,j0  ,j1  ,Y);

    }

    //epilogue pipeline
        if(r){
            line_dilatation3_ui8matrix_ilu3_red(T,i1,j0  ,j1  ,Y);
        }
}
